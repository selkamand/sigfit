<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Methods of Signature Fitting • sigfit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methods of Signature Fitting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sigfit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/methods_of_signature_fitting.html">Methods of Signature Fitting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/selkamand/sigfit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Methods of Signature Fitting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/selkamand/sigfit/blob/main/vignettes/methods_of_signature_fitting.Rmd" class="external-link"><code>vignettes/methods_of_signature_fitting.Rmd</code></a></small>
      <div class="d-none name"><code>methods_of_signature_fitting.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/selkamand/sigfit" class="external-link">sigfit</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is a detailed description of signature fitting
approaches implemented in sigfit. For a quick summary of which method to
use, consult <code>?sig_fit()</code>.</p>
<div class="section level3">
<h3 id="problem-statement">Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement"></a>
</h3>
<p>The issue we’re trying to solve in all of these approaches is to
optimally reconstruct an observed mutation profile (counts of different
types of mutations) using linear combinations of known mutational
signatures (proportions of different types of mutations) associated with
mutagenic aetiologies.</p>
<p>In plain words, we want to be able to say, for any observed mutation
profile: ‘80% of this profile was derived from tobacco smoking, and 20%
from damage by reactive oxygen species’ - which is only possible in the
first place because we know what a mutational profile from
tobacco-smoking and ROS damage look like in isolation.</p>
</div>
<div class="section level3">
<h3 id="common-matrix-representations">Common Matrix Representations<a class="anchor" aria-label="anchor" href="#common-matrix-representations"></a>
</h3>
<p>We will be defining individual signatures as column vectors of length
K (where K is the number of mutation types). In our examples, we’ll be
using signatures with 6 basic mutation types (C&gt;A, C&gt;G, C&gt;T,
T&gt;A, T&gt;C, T&gt;G)</p>
<p><span class="math display">$$
\begin{array}{c}\text{sig1} \\\begin{bmatrix}P_{C&gt;A} \\P_{C&gt;G}
\\P_{C&gt;T} \\P_{T&gt;A} \\P_{T&gt;C}
\\P_{T&gt;G}\end{bmatrix}\end{array}
\\~\\ \quad P_{\text{type}} = \text{  proportion of mutations by each
mutation type}
\\
\sum P_{type}  = 1
\\
type \in \{[C&gt;A], [C&gt;G], [C&gt;T], [T&gt;A], [T&gt;C], [T&gt;G]\}
\text{ }
$$</span></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="linear-algebra-approaches-solving-axb-for-x">Linear algebra approaches (Solving
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#linear-algebra-approaches-solving-axb-for-x"></a>
</h3>
<p>Say we want to explain an observed mutational profile using a
collection of 4 known signatures (with 6 different mutation types)</p>
<p>One approach is to formulate our problem as a system of linear
equations. In this framework, we aim to identify a linear combination of
the four signature vectors that precisely reproduces our observed
mutational profile. The coefficients in these linear equations represent
the number of mutations attributed to each signature and are denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">M</mtext><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mn>1</mn></mrow></msub><mo>,</mo><msub><mtext mathvariant="normal">M</mtext><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mn>2</mn></mrow></msub><mo>,</mo><msub><mtext mathvariant="normal">M</mtext><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mn>3</mn></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> &amp; </mtext><mspace width="0.333em"></mspace></mrow><msub><mtext mathvariant="normal">M</mtext><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mn>4</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{M}_{sig1}, \text{M}_{sig2}, \text{M}_{sig3}\text{ &amp; }\text{M}_{sig4}</annotation></semantics></math>​.
These coefficients are the unknowns we solve for in this system.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>M</mi><mtext mathvariant="normal">sig1</mtext></msub><mo>×</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">sig1</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>T</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>C</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><mo>+</mo><msub><mi>M</mi><mtext mathvariant="normal">sig2</mtext></msub><mo>×</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">sig2</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>T</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>C</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><mo>+</mo><msub><mi>M</mi><mtext mathvariant="normal">sig3</mtext></msub><mo>×</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">sig3</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>T</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>C</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><mo>+</mo><msub><mi>M</mi><mtext mathvariant="normal">sig4</mtext></msub><mo>×</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">sig4</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>T</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>C</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>P</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><mo>=</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Observed Profile</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>C</mi><mo>&gt;</mo><mi>T</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>A</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>C</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mrow><mi>T</mi><mo>&gt;</mo><mi>G</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{c}M_{\text{sig1}} \times \begin{array}{c}\text{sig1} \\\begin{bmatrix}P_{C&gt;A} \\P_{C&gt;G} \\P_{C&gt;T} \\P_{T&gt;A} \\P_{T&gt;C} \\P_{T&gt;G}\end{bmatrix}\end{array}+ M_{\text{sig2}} \times \begin{array}{c}\text{sig2} \\\begin{bmatrix}P_{C&gt;A} \\P_{C&gt;G} \\P_{C&gt;T} \\P_{T&gt;A} \\P_{T&gt;C} \\P_{T&gt;G}\end{bmatrix}\end{array}+ M_{\text{sig3}} \times \begin{array}{c}\text{sig3} \\\begin{bmatrix}P_{C&gt;A} \\P_{C&gt;G} \\P_{C&gt;T} \\P_{T&gt;A} \\P_{T&gt;C} \\P_{T&gt;G}\end{bmatrix}\end{array}+ M_{\text{sig4}} \times \begin{array}{c}\text{sig4} \\\begin{bmatrix}P_{C&gt;A} \\P_{C&gt;G} \\P_{C&gt;T} \\P_{T&gt;A} \\P_{T&gt;C} \\P_{T&gt;G}\end{bmatrix}\end{array}=\begin{array}{c}\text{Observed Profile} \\\begin{bmatrix}C_{C&gt;A} \\C_{C&gt;G} \\C_{C&gt;T} \\C_{T&gt;A} \\C_{T&gt;C} \\C_{T&gt;G}\end{bmatrix}\end{array}\end{array}
</annotation></semantics></math></p>
<p><span class="math display">$$
\text{Note that } P_{C&gt;A}\text{ is a different value in each
signature vector}\\
\text{Observed Profile } C_{types} \text{are the observed mutation
counts}
$$</span></p>
<p>This problem framing is equivalent to solving a set of
<strong>K</strong> simultaneous equations (in this case, 6 because there
are 6 mutation types)</p>
<p><span class="math display">$$
\text{Given all values of P and C, Solve for } \text{M}_{sig1},
\text{M}_{sig2}, \text{M}_{sig3}\text{ &amp; }\text{M}_{sig4} \text{:}
\\~\\
\begin{align*}M_{\text{sig1}} \times P_{C&gt;A}^{\text{sig1}} +
M_{\text{sig2}} \times P_{C&gt;A}^{\text{sig2}} + M_{\text{sig3}} \times
P_{C&gt;A}^{\text{sig3}} + M_{\text{sig4}} \times
P_{C&gt;A}^{\text{sig4}} &amp;= C_{C&gt;A} \\M_{\text{sig1}} \times
P_{C&gt;G}^{\text{sig1}} + M_{\text{sig2}} \times
P_{C&gt;G}^{\text{sig2}} + M_{\text{sig3}} \times
P_{C&gt;G}^{\text{sig3}} + M_{\text{sig4}} \times
P_{C&gt;G}^{\text{sig4}} &amp;= C_{C&gt;G} \\M_{\text{sig1}} \times
P_{C&gt;T}^{\text{sig1}} + M_{\text{sig2}} \times
P_{C&gt;T}^{\text{sig2}} + M_{\text{sig3}} \times
P_{C&gt;T}^{\text{sig3}} + M_{\text{sig4}} \times
P_{C&gt;T}^{\text{sig4}} &amp;= C_{C&gt;T} \\M_{\text{sig1}} \times
P_{T&gt;A}^{\text{sig1}} + M_{\text{sig2}} \times
P_{T&gt;A}^{\text{sig2}} + M_{\text{sig3}} \times
P_{T&gt;A}^{\text{sig3}} + M_{\text{sig4}} \times
P_{T&gt;A}^{\text{sig4}} &amp;= C_{T&gt;A} \\M_{\text{sig1}} \times
P_{T&gt;C}^{\text{sig1}} + M_{\text{sig2}} \times
P_{T&gt;C}^{\text{sig2}} + M_{\text{sig3}} \times
P_{T&gt;C}^{\text{sig3}} + M_{\text{sig4}} \times
P_{T&gt;C}^{\text{sig4}} &amp;= C_{T&gt;C} \\M_{\text{sig1}} \times
P_{T&gt;G}^{\text{sig1}} + M_{\text{sig2}} \times
P_{T&gt;G}^{\text{sig2}} + M_{\text{sig3}} \times
P_{T&gt;G}^{\text{sig3}} + M_{\text{sig4}} \times
P_{T&gt;G}^{\text{sig4}} &amp;= C_{T&gt;G}\end{align*}
$$</span></p>
<p>To solve for M, we first need to represent the problem in its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math>
matrix form (which most tools expect).</p>
<p><strong>Ax=b form of a system of linear equations:</strong></p>
<p><span class="math display">$$
\begin{array}{c@{\hskip 1cm}c@{\hskip 1.5cm}c}
\underbrace{
\begin{bmatrix}
P_{C&gt;A}^{\text{sig1}} &amp; P_{C&gt;A}^{\text{sig2}} &amp;
P_{C&gt;A}^{\text{sig3}} &amp; P_{C&gt;A}^{\text{sig4}} \\
P_{C&gt;G}^{\text{sig1}} &amp; P_{C&gt;G}^{\text{sig2}} &amp;
P_{C&gt;G}^{\text{sig3}} &amp; P_{C&gt;G}^{\text{sig4}} \\
P_{C&gt;T}^{\text{sig1}} &amp; P_{C&gt;T}^{\text{sig2}} &amp;
P_{C&gt;T}^{\text{sig3}} &amp; P_{C&gt;T}^{\text{sig4}} \\
P_{T&gt;A}^{\text{sig1}} &amp; P_{T&gt;A}^{\text{sig2}} &amp;
P_{T&gt;A}^{\text{sig3}} &amp; P_{T&gt;A}^{\text{sig4}} \\
P_{T&gt;C}^{\text{sig1}} &amp; P_{T&gt;C}^{\text{sig2}} &amp;
P_{T&gt;C}^{\text{sig3}} &amp; P_{T&gt;C}^{\text{sig4}} \\
P_{T&gt;G}^{\text{sig1}} &amp; P_{T&gt;G}^{\text{sig2}} &amp;
P_{T&gt;G}^{\text{sig3}} &amp; P_{T&gt;G}^{\text{sig4}} \\
\end{bmatrix}}_{A}
&amp;
\underbrace{
\begin{bmatrix}
M_{\text{sig1}} \\
M_{\text{sig2}} \\
M_{\text{sig3}} \\
M_{\text{sig4}} \\
\end{bmatrix}}_{x}
=
\underbrace{
\begin{bmatrix}
C_{C&gt;A} \\
C_{C&gt;G} \\
C_{C&gt;T} \\
C_{T&gt;A} \\
C_{T&gt;C} \\
C_{T&gt;G} \\
\end{bmatrix}}_{b}
\end{array}
$$</span></p>
<blockquote>
<p><strong>NOTE:</strong> If matrix representations of linear equations
are new to you, I recommend watching the <a href="https://youtu.be/J7DzL2_Na80?si=5bJcQfN8pNOWv2J_" class="external-link">MIT
OpenCourseWare Linear Algebra Course</a>.</p>
</blockquote>
<p>Once our problem is in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math>
form we can solve for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
using several basic linear algebra approaches. The most appropriate
method depends on range of matrix properties you need to support.</p>
<p>Typically, the QR decomposition based implementation in
<code><a href="https://rdrr.io/r/base/qr.html" class="external-link">base::qr.solve()</a></code> would be a good choice since it works well
for rectangular matrices and approximates solutions using least-squares
where appropriate (very important for dealing with
<strong>overdetermined</strong> &amp; <strong>undertermined</strong>
systems).</p>
<p>However, we have one key constraint:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x \geq 0</annotation></semantics></math>.
For this reason we will lean towards the following methods:</p>
<ul>
<li>
<p><strong>Non-Negative Least Squares (NNLS):</strong> Suitable for
least-squares problems with non-negativity constraints.</p>
<ul>
<li><code>nnls::nnls()</code></li>
</ul>
</li>
<li>
<p><strong>Linear Programming (LP):</strong> Suitable when
optimizing a linear objective function with linear constraints.</p>
<ul>
<li><code>lpSolve::lp()</code></li>
</ul>
</li>
<li>
<p><strong>Quadratic Programming (QP):</strong> Optimise quadratic
minimisation functions with linear constraints.</p>
<ul>
<li>
<code>quadprog::solve.QP()</code> to find
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
which minimises the Frobenius norm of Ax-b.</li>
</ul>
</li>
</ul>
<div class="section level4">
<h4 id="a-note-on-overdetermined-and-underdetermined-systems">A note on <strong>overdetermined</strong> and underdetermined
systems<a class="anchor" aria-label="anchor" href="#a-note-on-overdetermined-and-underdetermined-systems"></a>
</h4>
<p>This particular example is an <strong>Overdetermined System</strong>:
There are more equations (mutation types) than unknowns (signatures). In
most <strong>Overdetermined Systems</strong> there will be no solutions.
See <a href="https://en.wikipedia.org/wiki/Overdetermined_system#An_example_in_two_dimensions" class="external-link">here</a>
for an intuitive explanation on why this is. Approximate (least-squares)
solutions can be computed for overdetermined systems.</p>
<p>Use of other signature collections may lead to
<strong>Underdetermined Systems</strong>: These occur when there are
<strong>fewer</strong> equations (mutation types) than unknowns
(signatures). <strong>Underdetermined</strong> systems typically have no
solutions or infinitely many solutions - as there are not enough
constraints to uniquely determine all variables.</p>
</div>
<div class="section level4">
<h4 id="examples-in-r">Examples in R<a class="anchor" aria-label="anchor" href="#examples-in-r"></a>
</h4>
<div class="section level5">
<h5 id="section"></h5>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam El-Kamand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
